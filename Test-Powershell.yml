---
- name: Testing Creds to Powershell in AWX 
  hosts: localhost
  connection: local
  gather_facts: yes
  tasks:
    - name: Get Creds from Vault
      include_role:
        name: GetVaultCreds
      vars:
        includecred:
          - test
    - name: Run Powershell
      shell: |
        $TempCred = New-PSCredential -Username "{{ test_cred }}.username" -Password "{{ test_cred }}.password"
        $TempCred        
      args:
        executable: /usr/bin/pwsh